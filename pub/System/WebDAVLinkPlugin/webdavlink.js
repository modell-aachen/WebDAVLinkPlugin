(function(a){a.fn.extend({webdav_open:function(c){if(typeof(ActiveXObject)!="undefined"){var d=this.attr("href").replace(/\?.*?$/,"");var b,e,k,h;a("meta[name='WEBDAVLINK_MSAPPS']").each(function(){b=unescape(this.content)});if(b==null||b==""){if(typeof(foswiki)!="undefined"){b=unescape(foswiki.getMetaTag("WEBDAVLINK_MSAPPS"))}else{if(typeof(twiki)!="undefined"){b=unescape(twiki.getMetaTag("WEBDAVLINK_MSAPPS"))}}if(b==null||b==""){alert("No WEBDAVLINK_MSAPPS");return true}}e=a.parseJSON(b);for(var f in e){var g=new RegExp("\\.("+e[f]+")$");if(g.test(d)){var i=f.split(".");k=new ActiveXObject(i[0]+".Application");if(k!=null){h=k[i[1]]}break}}if(h!=null){k.Visible=true;h.Open(d);return false}}else{if(a.browser.mozilla){var j=document.createEvent("Events");j.initEvent("webdav_open",true,true);c.currentTarget.dispatchEvent(j);return false}}return true}});a(document).ready(function(){var b;a("meta[name='WEBDAVLINK_URLS']").each(function(){b=unescape(this.content)});if(b==null||b==""){if(typeof(foswiki)!="undefined"){b=foswiki.getMetaTag("WEBDAVLINK_URLS")}else{if(typeof(twiki)!="undefined"){b=twiki.getMetaTag("WEBDAVLINK_URLS")}}if(b==null||b==""){alert("No WEBDAVLINK_URLS");return}}b=new RegExp("^("+b+")");a("a:not(.webdav)").livequery(function(c){var d=a(this);if(b.test(this.href)){d.addClass("webdav jqTooltip").attr("title","Edit in native application");d.click(function(f){return d.webdav_open(f)})}})})})(jQuery);